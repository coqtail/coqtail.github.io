<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<link href="coqdoc.css" rel="stylesheet" type="text/css"/>
<title>Coqtail.Arith.Lagrange_four_square</title>
</head>

<body>

<div id="page">

<div id="header">
</div>

<div id="main">

<h1 class="libtitle">Library Coqtail.Arith.Lagrange_four_square</h1>

<div class="code">
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.ZArith.html#"><span class="id" type="library">ZArith</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.omega.Omega.html#"><span class="id" type="library">Omega</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#"><span class="id" type="library">Znumtheory</span></a>.<br/>
<span class="id" type="keyword">Require</span> <span class="id" type="keyword">Import</span> <a class="idref" href="Coqtail.Arith.Natsets.html#"><span class="id" type="library">Natsets</span></a> <a class="idref" href="Coqtail.mytheories.MyNat.html#"><span class="id" type="library">MyNat</span></a> <a class="idref" href="Coqtail.Arith.Ztools.html#"><span class="id" type="library">Ztools</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#"><span class="id" type="library">Zeqm</span></a> <a class="idref" href="Coqtail.Arith.Znumfacts.html#"><span class="id" type="library">Znumfacts</span></a>.<br/>

<br/>
</div>

<div class="doc">
Definition of the predicate : being the sum of four squares 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="foursquare"><span class="id" type="definition">foursquare</span></a> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a>) : <span class="id" type="keyword">Type</span> :=<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a><span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">:</span></a> <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">b</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">:</span></a> <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">:</span></a> <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">d</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">d</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">d</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">}}}</span></a>.<br/>

<br/>
</div>

<div class="doc">
Euler's identity and compatibility of the 4-square property wrt. multiplication 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="euler's_identity"><span class="id" type="lemma">euler's_identity</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> <span class="id" type="var">w</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">z</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a>,<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> <span class="id" type="var">s</span> <span class="id" type="var">z</span> := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#w"><span class="id" type="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#w"><span class="id" type="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#w"><span class="id" type="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#w"><span class="id" type="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#w"><span class="id" type="variable">w</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a><br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#s"><span class="id" type="variable">s</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#z"><span class="id" type="variable">z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#w"><span class="id" type="variable">w</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">s</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">ring</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="mult_foursquare_compat"><span class="id" type="lemma">mult_foursquare_compat</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a>,<br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>)%<span class="id" type="var">Z</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span> <span class="id" type="var">m</span> (<span class="id" type="var">a</span>, (<span class="id" type="var">b</span>, (<span class="id" type="var">c</span>, (<span class="id" type="var">d</span>, <span class="id" type="var">Hn</span>)))) (<span class="id" type="var">x</span>, (<span class="id" type="var">y</span>, (<span class="id" type="var">z</span>, (<span class="id" type="var">t</span>, <span class="id" type="var">Hm</span>)))); <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#euler's_identity"><span class="id" type="lemma">euler's_identity</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">eexists</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zmod_sqrt_eq_compat"><span class="id" type="lemma">Zmod_sqrt_eq_compat</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">p</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> →<br/>
&nbsp;&nbsp;(0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> → 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#j"><span class="id" type="variable">j</span></a> → 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#j"><span class="id" type="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#j"><span class="id" type="variable">j</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#j"><span class="id" type="variable">j</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#j"><span class="id" type="variable">j</span></a>)%<span class="id" type="var">Z</span>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">Pp</span> <span class="id" type="var">Pi</span> <span class="id" type="var">Pj</span> <span class="id" type="var">Bi</span> <span class="id" type="var">Bj</span> <span class="id" type="var">ES</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.ZArith_dec.html#Z_eq_dec"><span class="id" type="abbreviation">Z_eq_dec</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">j</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <span class="id" type="var">p</span>) 0) <span class="id" type="keyword">as</span> [ <span class="id" type="var">E</span> | <span class="id" type="var">E</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">j</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0); [ <span class="id" type="tactic">omega</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">j</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">p</span>); [ <span class="id" type="tactic">intros</span> <span class="id" type="var">H</span> | <span class="id" type="tactic">omega</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">E</span>; <span class="id" type="tactic">symmetry</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zmod_small"><span class="id" type="lemma">Zmod_small</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Znumfacts.html#modular_inverse"><span class="id" type="lemma">modular_inverse</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Pp</span> <span class="id" type="var">E</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">a</span>, <span class="id" type="var">Ha</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">i</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <span class="id" type="var">j</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a><span class="id" type="var">p</span><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">M</span>; <span class="id" type="tactic">red</span> <span class="id" type="keyword">in</span> <span class="id" type="var">M</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zmod_small"><span class="id" type="lemma">Zmod_small</span></a> <span class="id" type="var">i</span> <span class="id" type="var">p</span>), (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zmod_small"><span class="id" type="lemma">Zmod_small</span></a> <span class="id" type="var">j</span> <span class="id" type="var">p</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">M</span>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_minus_0"><span class="id" type="lemma">eqm_minus_0</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">j</span>) <span class="id" type="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">i</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">j</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> 1) <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Ha</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_minus_0"><span class="id" type="lemma">eqm_minus_0</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">ES</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">replace</span> 0 <span class="id" type="keyword">with</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">a</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">ES</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eq_eqm"><span class="id" type="lemma">eq_eqm</span></a>; <span class="id" type="tactic">ring</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prime_odd"><span class="id" type="lemma">prime_odd</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">p</span>, 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 1.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">N2</span> <span class="id" type="var">Pp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> 2) <span class="id" type="var">r</span> <span class="id" type="var">Er</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_mod_lt"><span class="id" type="lemma">Z_mod_lt</span></a> <span class="id" type="var">p</span> 2 <span class="id" type="keyword">as</span> <span class="id" type="var">help_omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> 0).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">help_omega</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">Rn</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#Zmod_divide"><span class="id" type="lemma">Zmod_divide</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Rn</span>; [ | <span class="id" type="tactic">omega</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<span class="id" type="var">N2</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime_div_prime"><span class="id" type="lemma">prime_div_prime</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span>)); <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime_2"><span class="id" type="lemma">prime_2</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="odd_bound_1"><span class="id" type="lemma">odd_bound_1</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">p</span> <span class="id" type="var">i</span>, <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 1 → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zsucc"><span class="id" type="abbreviation">Zsucc</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2) → 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">i</span> <span class="id" type="var">Op</span> <span class="id" type="var">Bi</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z.succ"><span class="id" type="definition">Zsucc</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Bi</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zle_lt_trans"><span class="id" type="abbreviation">Zle_lt_trans</span></a> <span class="id" type="keyword">with</span> (2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Z_mult_div_mod"><span class="id" type="lemma">Z_mult_div_mod</span></a>; [ | <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> × ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Op</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
<span class="inlinecode"><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a></span> <span class="inlinecode"><a class="idref" href="Coqtail.Fresh.Inhabited.Functions.html#x"><span class="id" type="axiom">x</span></a></span> <span class="inlinecode"><a class="idref" href="Coqtail.Vec.Vec_prop.html#m"><span class="id" type="variable">m</span></a></span> is the unique y congruent to x such that -m/2≤x&lt;m/2 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Definition</span> <a name="modsym"><span class="id" type="definition">modsym</span></a> <span class="id" type="var">x</span> <span class="id" type="var">m</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="modsym_bounds"><span class="id" type="lemma">modsym_bounds</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">≤</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span> <span class="id" type="var">Pm</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_mod_lt"><span class="id" type="lemma">Z_mod_lt</span></a> (<span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2) <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_mod_lt"><span class="id" type="lemma">Z_mod_lt</span></a> <span class="id" type="var">m</span> 2.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="var">ring_simplify</span>; <span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Z_mult_div_mod"><span class="id" type="lemma">Z_mult_div_mod</span></a>; <span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="modsym_mod_compat"><span class="id" type="lemma">modsym_mod_compat</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zminus_mod_idemp_l"><span class="id" type="lemma">Zminus_mod_idemp_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">ring</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="mod_modsym_compat"><span class="id" type="lemma">mod_modsym_compat</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>) <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zplus_mod_idemp_l"><span class="id" type="lemma">Zplus_mod_idemp_l</span></a>; <span class="id" type="tactic">auto</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="modsym_mod_diff"><span class="id" type="lemma">modsym_mod_diff</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">|</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">}</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <span class="id" type="var">x</span> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Z_mult_div_mod"><span class="id" type="lemma">Z_mult_div_mod</span></a>; [ | <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> × ].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zminus_mod"><span class="id" type="lemma">Zminus_mod</span></a>, <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_mod_compat"><span class="id" type="lemma">modsym_mod_compat</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zminus_mod_idemp_l"><span class="id" type="lemma">Zminus_mod_idemp_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zminus_mod_idemp_r"><span class="id" type="lemma">Zminus_mod_idemp_r</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zminus_diag"><span class="id" type="abbreviation">Zminus_diag</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zmod_0_l"><span class="id" type="lemma">Zmod_0_l</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">ring</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_mod_compat"><span class="id" type="lemma">modsym_mod_compat</span></a>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prime_div_false"><span class="id" type="lemma">prime_div_false</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">p</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a> → 1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#False"><span class="id" type="inductive">False</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">D</span> <span class="id" type="var">Bp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime_divisors"><span class="id" type="lemma">prime_divisors</span></a> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">a</span> <span class="id" type="var">D</span>) <span class="id" type="keyword">as</span> [|[|[|]]]; <span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="Zbounding_square"><span class="id" type="lemma">Zbounding_square</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span> <span class="id" type="var">Pm</span> <span class="id" type="var">Bx</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">simpl</span>; <span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z.pow_pos"><span class="id" type="definition">Zpower_pos</span></a>; <span class="id" type="tactic">simpl</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_assoc"><span class="id" type="abbreviation">Zmult_assoc</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_square"><span class="id" type="abbreviation">Zabs_square</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zle_trans"><span class="id" type="abbreviation">Zle_trans</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_assoc"><span class="id" type="abbreviation">Zmult_assoc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_compat_l"><span class="id" type="lemma">Zmult_le_compat_l</span></a>; <span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_comm"><span class="id" type="abbreviation">Zmult_comm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_compat_l"><span class="id" type="lemma">Zmult_le_compat_l</span></a>; <span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
All prime numbers divides some <span class="inlinecode">1+<a class="idref" href="Coqtail.Reals.Logic.Rmarkov.html#l"><span class="id" type="definition">l</span></a>²+<a class="idref" href="Coqtail.Vec.Vec_prop.html#m"><span class="id" type="variable">m</span></a>²</span> (plus convenient conditions on <span class="inlinecode"><a class="idref" href="Coqtail.Reals.Logic.Rmarkov.html#l"><span class="id" type="definition">l</span></a>,<a class="idref" href="Coqtail.Vec.Vec_prop.html#m"><span class="id" type="variable">m</span></a></span>) 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="prime_dividing_sum_of_two_squares_plus_one"><span class="id" type="lemma">prime_dividing_sum_of_two_squares_plus_one</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">p</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → 3 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> →	<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a><span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">:</span></a> <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">{</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">:</span></a> <span class="id" type="var">_</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">&amp;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">{</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">|</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a>  2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a>0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'\/'_x"><span class="id" type="notation">∨</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_'|'_x_'}'"><span class="id" type="notation">}</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#:type_scope:'{'_x_':'_x_'&'_x_'}'"><span class="id" type="notation">}}</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">Op</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">np</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> <span class="id" type="var">p</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">p_odd</span> : <span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 1) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#prime_odd"><span class="id" type="lemma">prime_odd</span></a>; <span class="id" type="tactic">auto</span> || <span class="id" type="tactic">omega</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">s</span> := <span class="id" type="keyword">fun</span> <span class="id" type="var">x</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a> ⇒ <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">s_pos</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">s</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">s</span>; <span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_square"><span class="id" type="abbreviation">Zabs_square</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_0_compat"><span class="id" type="abbreviation">Zmult_le_0_compat</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">mod_pos</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_mod_lt"><span class="id" type="lemma">Z_mod_lt</span></a>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">Pp</span>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">hp_pos</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_div_pos"><span class="id" type="lemma">Z_div_pos</span></a>; <span class="id" type="tactic">omega</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">autobound</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">i</span>, (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Peano.html#:nat_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2)))%<span class="id" type="var">nat</span> → 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#i"><span class="id" type="variable">i</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">i</span> <span class="id" type="var">Li</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_lt"><span class="id" type="definition">inj_lt</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Li</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_S"><span class="id" type="abbreviation">inj_S</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Li</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#odd_bound_1"><span class="id" type="lemma">odd_bound_1</span></a>; <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">FL</span> := <span class="id" type="keyword">fun</span> <span class="id" type="var">l</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">s</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#l"><span class="id" type="variable">l</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <span class="id" type="var">p</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">FM</span> := <span class="id" type="keyword">fun</span> <span class="id" type="var">m</span> ⇒ <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">(</span></a>-1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">s</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>)<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'mod'_x"><span class="id" type="notation">mod</span></a> <span class="id" type="var">p</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">IFL</span> : <a class="idref" href="Coqtail.Arith.Natsets.html#injective"><span class="id" type="definition">injective</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2))) <span class="id" type="var">FL</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">Li</span> <span class="id" type="var">Lj</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">FL</span> <span class="id" type="keyword">in</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zabs_nat_inj"><span class="id" type="lemma">Zabs_nat_inj</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">E</span>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_eq_rev"><span class="id" type="abbreviation">inj_eq_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#Zmod_sqrt_eq_compat"><span class="id" type="lemma">Zmod_sqrt_eq_compat</span></a> <span class="id" type="var">p</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">i</span>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">j</span>)); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">IFM</span> : <a class="idref" href="Coqtail.Arith.Natsets.html#injective"><span class="id" type="definition">injective</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2))) <span class="id" type="var">FM</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">i</span> <span class="id" type="var">j</span> <span class="id" type="var">Li</span> <span class="id" type="var">Lj</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">FM</span> <span class="id" type="keyword">in</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_eq_rev"><span class="id" type="abbreviation">inj_eq_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#Zmod_sqrt_eq_compat"><span class="id" type="lemma">Zmod_sqrt_eq_compat</span></a> <span class="id" type="var">p</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">i</span>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">j</span>)); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zabs_nat_inj"><span class="id" type="lemma">Zabs_nat_inj</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">E</span>; <span class="id" type="tactic">eauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_minus_0"><span class="id" type="lemma">eqm_minus_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_minus_0"><span class="id" type="lemma">eqm_minus_0</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eq_eqm"><span class="id" type="lemma">eq_eqm</span></a>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">s</span>; <span class="id" type="tactic">ring</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">BFL</span> : <a class="idref" href="Coqtail.Arith.Natsets.html#bounded"><span class="id" type="definition">bounded</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2))) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> <span class="id" type="var">p</span>) <span class="id" type="var">FL</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">i</span> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">FL</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_lt_rev"><span class="id" type="abbreviation">inj_lt_rev</span></a>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_mod_lt"><span class="id" type="lemma">Z_mod_lt</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">BFM</span> : <a class="idref" href="Coqtail.Arith.Natsets.html#bounded"><span class="id" type="definition">bounded</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2))) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> <span class="id" type="var">p</span>) <span class="id" type="var">FM</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">i</span> <span class="id" type="var">_</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">FM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_lt_rev"><span class="id" type="abbreviation">inj_lt_rev</span></a>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_mod_lt"><span class="id" type="lemma">Z_mod_lt</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">CL</span> := <a class="idref" href="Coqtail.Arith.Natsets.html#count_image_injective"><span class="id" type="lemma">count_image_injective</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2))) <span class="id" type="var">np</span> <span class="id" type="var">FL</span> <span class="id" type="var">IFL</span> <span class="id" type="var">BFL</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">CM</span> := <a class="idref" href="Coqtail.Arith.Natsets.html#count_image_injective"><span class="id" type="lemma">count_image_injective</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2))) <span class="id" type="var">np</span> <span class="id" type="var">FM</span> <span class="id" type="var">IFM</span> <span class="id" type="var">BFM</span>).<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Coqtail.Arith.Natsets.html#image"><span class="id" type="definition">image</span></a> <span class="id" type="var">FL</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2)))) <span class="id" type="keyword">as</span> <span class="id" type="var">L</span>.<br/>
&nbsp;&nbsp;<span class="id" type="var">remember</span> (<a class="idref" href="Coqtail.Arith.Natsets.html#image"><span class="id" type="definition">image</span></a> <span class="id" type="var">FM</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> 2)))) <span class="id" type="keyword">as</span> <span class="id" type="var">M</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Natsets.html#count_drawers"><span class="id" type="lemma">count_drawers</span></a> <span class="id" type="var">L</span> <span class="id" type="var">M</span> <span class="id" type="var">np</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">i</span>, (<span class="id" type="var">Bi</span>, (<span class="id" type="var">Li</span>, <span class="id" type="var">Mi</span>))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">CL</span>, <span class="id" type="var">CM</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_lt_rev"><span class="id" type="abbreviation">inj_lt_rev</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_plus"><span class="id" type="abbreviation">inj_plus</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_S"><span class="id" type="abbreviation">inj_S</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">np</span>; <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z.succ"><span class="id" type="definition">Zsucc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Z_mult_div_bounds"><span class="id" type="lemma">Z_mult_div_bounds</span></a> <span class="id" type="var">p</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">HeqL</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Li</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">HeqM</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Mi</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Natsets.html#image_true"><span class="id" type="lemma">image_true</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Li</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">l</span>, (<span class="id" type="var">Bl</span>, <span class="id" type="var">Hl</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Natsets.html#image_true"><span class="id" type="lemma">image_true</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Mi</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">m</span>, (<span class="id" type="var">Bm</span>, <span class="id" type="var">Hm</span>)).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">l</span>); <span class="id" type="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">FL</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hl</span>; <span class="id" type="tactic">unfold</span> <span class="id" type="var">FM</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">HeqL</span> <span class="id" type="var">CL</span> <span class="id" type="var">HeqM</span> <span class="id" type="var">CM</span> <span class="id" type="var">Li</span> <span class="id" type="var">Mi</span> <span class="id" type="var">IFL</span> <span class="id" type="var">IFM</span> <span class="id" type="var">BFL</span> <span class="id" type="var">BFM</span> <span class="id" type="var">FL</span> <span class="id" type="var">FM</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_eq"><span class="id" type="definition">inj_eq</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hm</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hm</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">symmetry</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Hm</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_minus_0"><span class="id" type="lemma">eqm_minus_0</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Hm</span>; <span class="id" type="var">notzero</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <span class="id" type="var">s_pos</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">l</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <span class="id" type="var">s_pos</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Ztools.html#Zdivide_inf"><span class="id" type="lemma">Zdivide_inf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Hm</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">k</span>, <span class="id" type="var">Hk</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">k</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">k</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_lt_0_reg_r"><span class="id" type="lemma">Zmult_lt_0_reg_r</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">p</span>; <span class="id" type="tactic">assumption</span> || <span class="id" type="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (3 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> 3 <span class="id" type="keyword">with</span> (1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> 3) <span class="id" type="tactic">by</span> <span class="id" type="tactic">reflexivity</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_compat"><span class="id" type="lemma">Zmult_le_compat</span></a>; <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">split</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_comm"><span class="id" type="abbreviation">Zmult_comm</span></a>, &lt;- <span class="id" type="var">Hk</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">s</span>; <span class="id" type="tactic">ring</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">l</span>) <span class="id" type="var">lz</span> <span class="id" type="var">Elz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> <span class="id" type="var">m</span>) <span class="id" type="var">mz</span> <span class="id" type="var">Emz</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <span class="id" type="var">lz</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'\/'_x"><span class="id" type="notation">∨</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <span class="id" type="var">mz</span>); [ <span class="id" type="tactic">omega</span> | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <span class="id" type="var">s</span> <span class="id" type="var">lz</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'\/'_x"><span class="id" type="notation">∨</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <span class="id" type="var">s</span> <span class="id" type="var">mz</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="keyword">∀</span> <span class="id" type="var">a</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <span class="id" type="var">s</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> → 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a>). &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Hyp</span> [?|?]; [<span class="id" type="tactic">left</span>|<span class="id" type="tactic">right</span>]; <span class="id" type="tactic">apply</span> <span class="id" type="var">Hyp</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> [] <span class="id" type="var">H</span>; <span class="id" type="tactic">tauto</span> || <span class="id" type="var">zify</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Building bounds to prove things like x1²+x2²+x3²+x4²=m² /\ -m/2≤xi&lt;m/2 =&gt; xi=-m/2 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="egality_case_sum_of_four"><span class="id" type="lemma">egality_case_sum_of_four</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> <span class="id" type="var">M</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">((</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">))</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">((</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">))</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="square_bound_equality_case"><span class="id" type="lemma">square_bound_equality_case</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">M</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">M</span> <span class="id" type="var">Bounds</span> <span class="id" type="var">Bsqr</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.ZArith_dec.html#Z_le_dec"><span class="id" type="definition">Z_le_dec</span></a> 0 <span class="id" type="var">M</span>); [ | <span class="id" type="tactic">omega</span> ].<br/>
&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">M</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">a</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intro</span>; <span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_square"><span class="id" type="abbreviation">Zabs_square</span></a> <span class="id" type="var">M</span>), &lt;- (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_square"><span class="id" type="abbreviation">Zabs_square</span></a> <span class="id" type="var">a</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">Bsqr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#sqrt_le_compat"><span class="id" type="lemma">sqrt_le_compat</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="square_bound"><span class="id" type="lemma">square_bound</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span> <span class="id" type="var">Bx</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Pm</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">m</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_square"><span class="id" type="abbreviation">Zabs_square</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zle_trans"><span class="id" type="abbreviation">Zle_trans</span></a> <span class="id" type="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">x</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_compat_l"><span class="id" type="lemma">Zmult_le_compat_l</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_compat_r"><span class="id" type="lemma">Zmult_le_compat_r</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="square_bound_opp"><span class="id" type="lemma">square_bound_opp</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span>, <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">m</span> <span class="id" type="var">Bx</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_opp_opp"><span class="id" type="abbreviation">Zmult_opp_opp</span></a> <span class="id" type="var">m</span> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#square_bound"><span class="id" type="lemma">square_bound</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="egality_case_sum_of_four_squares"><span class="id" type="lemma">egality_case_sum_of_four_squares</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> <span class="id" type="var">M</span>,<br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> →<br/>
&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">((</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">))</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">((</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#M"><span class="id" type="variable">M</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">))</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">c</span> <span class="id" type="var">d</span> <span class="id" type="var">m</span> <span class="id" type="var">Ba</span> <span class="id" type="var">Bb</span> <span class="id" type="var">Bc</span> <span class="id" type="var">Bd</span> <span class="id" type="var">E</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">P</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">m</span> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">m</span>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">omega</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#square_bound"><span class="id" type="lemma">square_bound</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">P</span> <span class="id" type="var">_</span> <span class="id" type="var">Ba</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#square_bound"><span class="id" type="lemma">square_bound</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">P</span> <span class="id" type="var">_</span> <span class="id" type="var">Bb</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#square_bound"><span class="id" type="lemma">square_bound</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">P</span> <span class="id" type="var">_</span> <span class="id" type="var">Bc</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#square_bound"><span class="id" type="lemma">square_bound</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> (<span class="id" type="var">P</span> <span class="id" type="var">_</span> <span class="id" type="var">Bd</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Pm</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">m</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">b</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">c</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">d</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span>; <span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">split</span>; (<span class="id" type="tactic">rewrite</span> &lt;- (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a> <span class="id" type="var">m</span>); [ | <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> × ]);<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#sqrt_eq_compat_abs"><span class="id" type="lemma">sqrt_eq_compat_abs</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
</div>

<div class="doc">
If <span class="inlinecode"><span class="id" type="var">mp</span></span> is the sum of four squares, then so is <span class="inlinecode"><span class="id" type="var">np</span></span> for a smaller <span class="inlinecode"><a class="idref" href="Coqtail.Hierarchy.Type_class_instance.html#Z_nZ.n"><span class="id" type="variable">n</span></a></span> 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="foursquare_prime_factor_decreasing"><span class="id" type="lemma">foursquare_prime_factor_decreasing</span></a> :<br/>
&nbsp;&nbsp;<span class="id" type="keyword">∀</span> <span class="id" type="var">p</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → <span class="id" type="keyword">∀</span> <span class="id" type="var">m</span>, (1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>)%<span class="id" type="var">Z</span> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>) →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#sigT"><span class="id" type="inductive">sigT</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> ⇒ ((0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>)%<span class="id" type="var">Z</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>))%<span class="id" type="var">type</span>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">m</span> (<span class="id" type="var">LBm</span>, <span class="id" type="var">UBm</span>) <span class="id" type="var">FSmp</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">help0</span> : <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> 0); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">help1</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">m</span>); <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">FSmp</span> <span class="id" type="keyword">as</span> (<span class="id" type="var">x1</span>, (<span class="id" type="var">x2</span>, (<span class="id" type="var">x3</span>, (<span class="id" type="var">x4</span>, <span class="id" type="var">Hx</span>)))).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">y1</span> := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <span class="id" type="var">x1</span> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">y2</span> := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <span class="id" type="var">x2</span> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">y3</span> := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <span class="id" type="var">x3</span> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">y4</span> := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <span class="id" type="var">x4</span> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">eqm1</span> : <span class="id" type="var">y1</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <span class="id" type="var">x1</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a><span class="id" type="var">m</span><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">eqm2</span> : <span class="id" type="var">y2</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <span class="id" type="var">x2</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a><span class="id" type="var">m</span><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">eqm3</span> : <span class="id" type="var">y3</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <span class="id" type="var">x3</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a><span class="id" type="var">m</span><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">eqm4</span> : <span class="id" type="var">y4</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <span class="id" type="var">x4</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a><span class="id" type="var">m</span><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Dm</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y4</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">eqm1</span>, <span class="id" type="var">eqm2</span>, <span class="id" type="var">eqm3</span>, <span class="id" type="var">eqm4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#multiple_eqm"><span class="id" type="lemma">multiple_eqm</span></a>; <span class="id" type="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Dmp</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:'~'_x"><span class="id" type="notation">¬</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <span class="id" type="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#prime_div_false"><span class="id" type="lemma">prime_div_false</span></a>; <span class="id" type="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Ztools.html#Zdivide_inf"><span class="id" type="lemma">Zdivide_inf</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">Dm</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">r</span>, <span class="id" type="var">Hr</span>).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">∃</span> <span class="id" type="var">r</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Pr</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_0_reg_r"><span class="id" type="lemma">Zmult_le_0_reg_r</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Nr</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <span class="id" type="var">r</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Zr</span>; <span class="id" type="tactic">subst</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span> (0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span>) <span class="id" type="keyword">in</span> <span class="id" type="var">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">y0</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> 0<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zeq_0_square"><span class="id" type="lemma">Zeq_0_square</span></a> <span class="id" type="var">y1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zeq_0_square"><span class="id" type="lemma">Zeq_0_square</span></a> <span class="id" type="var">y2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zeq_0_square"><span class="id" type="lemma">Zeq_0_square</span></a> <span class="id" type="var">y3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zle_0_square"><span class="id" type="lemma">Zle_0_square</span></a> <span class="id" type="var">y4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zeq_0_square"><span class="id" type="lemma">Zeq_0_square</span></a> <span class="id" type="var">y4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Dmp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zmult_divide_compat_rev_l"><span class="id" type="lemma">Zmult_divide_compat_rev_l</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#Zdivide_plus_r"><span class="id" type="abbreviation">Zdivide_plus_r</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zdivide_square"><span class="id" type="lemma">Zdivide_square</span></a>, <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">eqm1</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eq_eqm"><span class="id" type="lemma">eq_eqm</span></a>; <span class="id" type="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">eqm2</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eq_eqm"><span class="id" type="lemma">eq_eqm</span></a>; <span class="id" type="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">eqm3</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eq_eqm"><span class="id" type="lemma">eq_eqm</span></a>; <span class="id" type="tactic">tauto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">eqm4</span>; <span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eq_eqm"><span class="id" type="lemma">eq_eqm</span></a>; <span class="id" type="tactic">tauto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Lrm</span> : <span class="id" type="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_reg_r"><span class="id" type="lemma">Zmult_le_reg_r</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Hr</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_reg_r"><span class="id" type="lemma">Zmult_le_reg_r</span></a> <span class="id" type="keyword">with</span> 4; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -<span class="id" type="var">help1</span> <span class="id" type="var">LBm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">B</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, 4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a>2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -<span class="id" type="var">help1</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">x</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_bounds"><span class="id" type="lemma">modsym_bounds</span></a> <span class="id" type="var">x</span> <span class="id" type="var">m</span> <span class="id" type="var">help1</span> <span class="id" type="keyword">as</span> <span class="id" type="var">Bms</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">set</span> (<span class="id" type="var">y</span> := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym"><span class="id" type="definition">modsym</span></a> <span class="id" type="var">x</span> <span class="id" type="var">m</span>); <span class="id" type="tactic">fold</span> <span class="id" type="var">y</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Bms</span>; <span class="id" type="var">clearbody</span> <span class="id" type="var">y</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2) <span class="id" type="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2) <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#Zbounding_square"><span class="id" type="lemma">Zbounding_square</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">now</span> <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <span class="id" type="var">B</span> <span class="id" type="var">x1</span> <span class="id" type="keyword">as</span> <span class="id" type="var">Ey1</span>; <span class="id" type="tactic">fold</span> <span class="id" type="var">y1</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Ey1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <span class="id" type="var">B</span> <span class="id" type="var">x2</span> <span class="id" type="keyword">as</span> <span class="id" type="var">Ey2</span>; <span class="id" type="tactic">fold</span> <span class="id" type="var">y2</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Ey2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <span class="id" type="var">B</span> <span class="id" type="var">x3</span> <span class="id" type="keyword">as</span> <span class="id" type="var">Ey3</span>; <span class="id" type="tactic">fold</span> <span class="id" type="var">y3</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Ey3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> <span class="id" type="var">B</span> <span class="id" type="var">x4</span> <span class="id" type="keyword">as</span> <span class="id" type="var">Ey4</span>; <span class="id" type="tactic">fold</span> <span class="id" type="var">y4</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Ey4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Nmr</span> : <span class="id" type="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'<>'_x"><span class="id" type="notation">≠</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Emr</span>; <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Eyi</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Eyi</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">∧</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'/\'_x"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#egality_case_sum_of_four_squares"><span class="id" type="lemma">egality_case_sum_of_four_squares</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> (<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_bounds"><span class="id" type="lemma">modsym_bounds</span></a>; <span class="id" type="var">notzero</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Hr</span>; <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Eyi</span> <span class="id" type="keyword">as</span> ((<span class="id" type="var">Ey1</span>, <span class="id" type="var">Ey2</span>), (<span class="id" type="var">Ey3</span>, <span class="id" type="var">Ey4</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">Dmp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zmult_divide_compat_rev_l"><span class="id" type="lemma">Zmult_divide_compat_rev_l</span></a> <span class="id" type="keyword">with</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hx</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Ztools.html#Zmult_divide_compat_rev_l"><span class="id" type="lemma">Zmult_divide_compat_rev_l</span></a> <span class="id" type="keyword">with</span> 4; <span class="id" type="var">notzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="var">notzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">REW</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">x</span>, 4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a>) <span class="id" type="tactic">by</span> (<span class="id" type="tactic">intros</span>; <span class="id" type="tactic">ring</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <span class="id" type="var">REW</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">REW</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="keyword">∀</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span>, 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">m</span> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#y"><span class="id" type="variable">y</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a><span class="id" type="var">m</span><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a> →<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a>2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#x"><span class="id" type="variable">x</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">≡</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">[</span></a>4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a><a class="idref" href="Coqtail.Arith.Zeqm.html#::x_'≡'_x_'['_x_']'"><span class="id" type="notation">]</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">HYP</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> <span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Zplus_eqm"><span class="id" type="instance">Zplus_eqm</span></a>;<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">eapply</span> <span class="id" type="var">HYP</span>; [ | <span class="id" type="var">eassumption</span> ]; <span class="id" type="var">eassumption</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">x</span> <span class="id" type="var">y</span> <span class="id" type="var">Ey</span> <span class="id" type="var">Mxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_square_half"><span class="id" type="lemma">eqm_square_half</span></a>; <span class="id" type="var">notzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Ey</span> <span class="id" type="tactic">at</span> 2.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_mult_compat_l"><span class="id" type="lemma">eqm_mult_compat_l</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <span class="id" type="var">Mxy</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y</span>) <span class="id" type="keyword">with</span> (<span class="id" type="var">y</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Ey</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#eqm_minus_0"><span class="id" type="lemma">eqm_minus_0</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="var">notzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (- 1); <span class="id" type="tactic">ring</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="var">notzero</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> 1; <span class="id" type="tactic">ring</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Erpm</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">r</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Hx</span>, &lt;-<span class="id" type="var">Hr</span> <span class="id" type="keyword">in</span> <span class="id" type="var">Erpm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#euler's_identity"><span class="id" type="lemma">euler's_identity</span></a> <span class="id" type="keyword">in</span> <span class="id" type="var">Erpm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x4</span>) <span class="id" type="var">t1</span> <span class="id" type="var">Et1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x3</span>) <span class="id" type="var">t2</span> <span class="id" type="var">Et2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x2</span>) <span class="id" type="var">t3</span> <span class="id" type="var">Et3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">y1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <span class="id" type="var">y3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> <span class="id" type="var">y4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">x1</span>) <span class="id" type="var">t4</span> <span class="id" type="var">Et4</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">D1</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <span class="id" type="var">t1</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="tactic">auto</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Et1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">y1</span>, <span class="id" type="var">y2</span>, <span class="id" type="var">y3</span>, <span class="id" type="var">y4</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="Coqtail.Arith.Zeqm.html#multiple_eqm"><span class="id" type="lemma">multiple_eqm</span></a>; <span class="id" type="tactic">eauto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">D2</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <span class="id" type="var">t2</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="tactic">auto</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Et2</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">y1</span>, <span class="id" type="var">y2</span>, <span class="id" type="var">y3</span>, <span class="id" type="var">y4</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">try</span> <span class="id" type="tactic">ring</span> .<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">red</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">ring</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">D3</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <span class="id" type="var">t3</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="tactic">auto</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Et3</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">y1</span>, <span class="id" type="var">y2</span>, <span class="id" type="var">y3</span>, <span class="id" type="var">y4</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">red</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">ring</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">D4</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <span class="id" type="var">t4</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="Coqtail.Arith.Zeqm.html#divide_eqm"><span class="id" type="lemma">divide_eqm</span></a>; <span class="id" type="tactic">auto</span>; <span class="id" type="tactic">rewrite</span> <span class="id" type="var">Et4</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">y1</span>, <span class="id" type="var">y2</span>, <span class="id" type="var">y3</span>, <span class="id" type="var">y4</span>; <span class="id" type="tactic">repeat</span> <span class="id" type="tactic">rewrite</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#modsym_eqm"><span class="id" type="lemma">modsym_eqm</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">red</span>; <span class="id" type="tactic">f_equal</span>; <span class="id" type="tactic">ring</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<span class="id" type="var">t1</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> <span class="id" type="var">m</span>); <span class="id" type="tactic">∃</span> (<span class="id" type="var">t2</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> <span class="id" type="var">m</span>); <span class="id" type="tactic">∃</span> (<span class="id" type="var">t3</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> <span class="id" type="var">m</span>); <span class="id" type="tactic">∃</span> (<span class="id" type="var">t4</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_reg_r"><span class="id" type="abbreviation">Zmult_reg_r</span></a> <span class="id" type="keyword">with</span> (<span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -<span class="id" type="var">help0</span>; <span class="id" type="tactic">destruct</span> <span class="id" type="var">m</span>; <span class="id" type="tactic">auto</span>; <span class="id" type="tactic">intro</span> <span class="id" type="var">H</span>; <span class="id" type="tactic">inversion</span> <span class="id" type="var">H</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Erpm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">cut</span> (<span class="id" type="keyword">∀</span> <span class="id" type="var">a</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">(</span></a><span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">|</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:'('_x_'|'_x_')'"><span class="id" type="notation">)</span></a> → <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'/'_x"><span class="id" type="notation">/</span></a> <span class="id" type="var">m</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'^'_x"><span class="id" type="notation">^</span></a> 2).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">Q</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">do</span> 4 (<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Q</span>; <span class="id" type="tactic">auto</span>).<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -<span class="id" type="var">help0</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">D</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Ztools.html#Zdivide_inf"><span class="id" type="lemma">Zdivide_inf</span></a> <span class="id" type="var">m</span> <span class="id" type="var">a</span> <span class="id" type="var">D</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">k</span>, <span class="id" type="var">E</span>); <span class="id" type="tactic">subst</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zdiv.html#Z_div_mult_full"><span class="id" type="lemma">Z_div_mult_full</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">ring</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Induction scheme to use the previous lemma 
</div>
<div class="code">
<span class="id" type="keyword">Definition</span> <a name="lt_wf_rect"><span class="id" type="definition">lt_wf_rect</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">fun</span> <span class="id" type="var">p</span> (<span class="id" type="var">P</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> → <span class="id" type="keyword">Type</span>) <span class="id" type="var">F</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Wf.html#well_founded_induction_type"><span class="id" type="lemma">well_founded_induction_type</span></a><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Arith.Wf_nat.html#well_founded_ltof"><span class="id" type="lemma">well_founded_ltof</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#nat"><span class="id" type="inductive">nat</span></a> (<span class="id" type="keyword">fun</span> <span class="id" type="var">m</span> ⇒ <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>)) <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#P"><span class="id" type="variable">P</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#F"><span class="id" type="variable">F</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>.<br/>

<br/>
</div>

<div class="doc">
Using the previous lemma, one can decrease <span class="inlinecode"><span class="id" type="var">mp</span></span> into <span class="inlinecode"><span class="id" type="var">np</span></span> to eventually get <span class="inlinecode"><a class="idref" href="Coqtail.Hierarchy.Type_class_instance.html#Fp.p"><span class="id" type="variable">p</span></a></span> 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Lemma</span> <a name="foursquare_prime"><span class="id" type="lemma">foursquare_prime</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">p</span>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime"><span class="id" type="inductive">prime</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span>.<br/>

<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.ZArith_dec.html#Z_eq_dec"><span class="id" type="abbreviation">Z_eq_dec</span></a> <span class="id" type="var">p</span> 2) <span class="id" type="keyword">as</span> [<span class="id" type="var">E</span> | <span class="id" type="var">E</span>].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">∃</span> 1%<span class="id" type="var">Z</span>; <span class="id" type="tactic">do</span> 2 <span class="id" type="tactic">∃</span> 0%<span class="id" type="var">Z</span>; <span class="id" type="tactic">auto</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (3 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">p</span>) <span class="id" type="keyword">as</span> <span class="id" type="var">Op</span> <span class="id" type="tactic">by</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="tactic">pose</span> <span class="id" type="var">proof</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znumtheory.html#prime_ge_2"><span class="id" type="lemma">prime_ge_2</span></a> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span>); <span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">E</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">pose</span> (<span class="id" type="var">fs_mult</span> := <span class="id" type="keyword">fun</span> <span class="id" type="var">p</span> <span class="id" type="var">m</span> ⇒<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#prod"><span class="id" type="inductive">prod</span></a> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>))<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#m"><span class="id" type="variable">m</span></a>) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#p"><span class="id" type="variable">p</span></a>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Specif.html#sigT"><span class="id" type="inductive">sigT</span></a> (<span class="id" type="var">fs_mult</span> <span class="id" type="var">p</span>)) <span class="id" type="keyword">as</span> <span class="id" type="var">Hm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#prime_dividing_sum_of_two_squares_plus_one"><span class="id" type="lemma">prime_dividing_sum_of_two_squares_plus_one</span></a> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">Op</span>) <span class="id" type="keyword">as</span><br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;(<span class="id" type="var">l</span>, (<span class="id" type="var">m</span>, (<span class="id" type="var">k</span>, (<span class="id" type="var">Ep</span>, (<span class="id" type="var">Bm</span>, (<span class="id" type="var">Bl</span>, (<span class="id" type="var">Pk</span>, <span class="id" type="var">Plm</span>))))))).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">tech1</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> 1))) <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <span class="id" type="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_S"><span class="id" type="abbreviation">inj_S</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a>; [ | <span class="id" type="tactic">omega</span> ]; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> 1)); <span class="id" type="tactic">split</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> 0%<span class="id" type="var">Z</span>; <span class="id" type="tactic">∃</span> 1%<span class="id" type="var">Z</span>; <span class="id" type="tactic">∃</span> <span class="id" type="var">l</span>; <span class="id" type="tactic">∃</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">k</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">tech1</span>; <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Ep</span>; <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">tech1</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">tech1</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_lt_reg_r"><span class="id" type="lemma">Zmult_lt_reg_r</span></a> <span class="id" type="keyword">with</span> (4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span>); [ <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> × | ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a>4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a>) <span class="id" type="keyword">with</span> (2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">k</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a>4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a>) <span class="id" type="keyword">with</span> (4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">(</span></a><span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">k</span><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">)</span></a>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <span class="id" type="var">Ep</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">tech2</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> → 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> → 4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">Pa</span> <span class="id" type="var">LT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">LE</span> : 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">b</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Pda</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 1) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">LE2</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_compat"><span class="id" type="lemma">Zmult_le_compat</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">LE</span> <span class="id" type="var">LE</span> <span class="id" type="var">Pda</span> <span class="id" type="var">Pda</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zlt_le_trans"><span class="id" type="abbreviation">Zlt_le_trans</span></a>; [ | <span class="id" type="tactic">apply</span> <span class="id" type="var">LE2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">tech3</span> : <span class="id" type="keyword">∀</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> → 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> → 4 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span>; <span class="id" type="tactic">intros</span> <span class="id" type="var">a</span> <span class="id" type="var">b</span> <span class="id" type="var">Pa</span> <span class="id" type="var">LT</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">LE</span> : 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <span class="id" type="var">b</span>) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">Pda</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> 2 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">a</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 1) <span class="id" type="tactic">by</span> <span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">LE2</span> := <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_le_compat"><span class="id" type="lemma">Zmult_le_compat</span></a> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">_</span> <span class="id" type="var">LE</span> <span class="id" type="var">LE</span> <span class="id" type="var">Pda</span> <span class="id" type="var">Pda</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">eapply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zlt_le_trans"><span class="id" type="abbreviation">Zlt_le_trans</span></a>; [ | <span class="id" type="tactic">apply</span> <span class="id" type="var">LE2</span> ].<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">p2_pos</span> : 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">transitivity</span> (1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zorder.html#Zmult_lt_compat_r"><span class="id" type="lemma">Zmult_lt_compat_r</span></a>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">l</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">l</span>) <span class="id" type="var">ll</span> <span class="id" type="var">Ell</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">m</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">m</span>) <span class="id" type="var">mm</span> <span class="id" type="var">Emm</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">rem</span> (<span class="id" type="var">p</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <span class="id" type="var">p</span>) <span class="id" type="var">pp</span> <span class="id" type="var">Epp</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Plm</span> <span class="id" type="keyword">as</span> (<span class="id" type="var">NNl</span>, (<span class="id" type="var">NNm</span>, [<span class="id" type="var">Pl</span> | <span class="id" type="var">Pm</span>])).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">tech2</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> <span class="id" type="var">Pl</span> <span class="id" type="var">Bl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">tech3</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> <span class="id" type="var">NNm</span> <span class="id" type="var">Bm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_assoc"><span class="id" type="abbreviation">Zmult_assoc</span></a>, &lt;-<span class="id" type="var">Ell</span>, &lt;-<span class="id" type="var">Emm</span>, &lt;-<span class="id" type="var">Epp</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -<span class="id" type="var">tech2</span> <span class="id" type="var">tech3</span> <span class="id" type="var">p2_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">tech2</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> <span class="id" type="var">Pm</span> <span class="id" type="var">Bm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">specialize</span> (<span class="id" type="var">tech3</span> <span class="id" type="var">_</span> <span class="id" type="var">p</span> <span class="id" type="var">NNl</span> <span class="id" type="var">Bl</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> &lt;- <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zmult_assoc"><span class="id" type="abbreviation">Zmult_assoc</span></a>, &lt;-<span class="id" type="var">Ell</span>, &lt;-<span class="id" type="var">Emm</span>, &lt;-<span class="id" type="var">Epp</span> <span class="id" type="keyword">in</span> ×.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> -<span class="id" type="var">tech2</span> <span class="id" type="var">tech3</span> <span class="id" type="var">p2_pos</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">ring_simplify</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">omega</span>.<br/>

<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">clear</span> <span class="id" type="var">Op</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">Hm</span> <span class="id" type="keyword">as</span> (<span class="id" type="var">m</span>, <span class="id" type="var">Hm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">generalize</span> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">m</span> <span class="id" type="var">Hm</span>; <span class="id" type="tactic">clear</span> <span class="id" type="var">Hm</span> <span class="id" type="var">m</span> <span class="id" type="var">Pp</span> <span class="id" type="var">p</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">refine</span> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#lt_wf_rect"><span class="id" type="definition">lt_wf_rect</span></a> <span class="id" type="var">m</span> (<span class="id" type="keyword">fun</span> <span class="id" type="var">n</span> ⇒ <span class="id" type="var">fs_mult</span> <span class="id" type="var">p</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> <span class="id" type="var">p</span>) <span class="id" type="var">_</span>); <span class="id" type="tactic">clear</span> <span class="id" type="var">m</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">intros</span> [|<span class="id" type="var">m</span>] <span class="id" type="var">IH</span> (<span class="id" type="var">FSm</span>, <span class="id" type="var">UBm</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> <span class="id" type="var">p</span>; <span class="id" type="tactic">assumption</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">assert</span> (<span class="id" type="var">LBm</span> : 1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<'_x"><span class="id" type="notation">&lt;</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z_of_nat"><span class="id" type="abbreviation">Z_of_nat</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#S"><span class="id" type="constructor">S</span></a> <span class="id" type="var">m</span>))) <span class="id" type="tactic">by</span> (<span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare_prime_factor_decreasing"><span class="id" type="lemma">foursquare_prime_factor_decreasing</span></a> <span class="id" type="var">p</span> <span class="id" type="var">Pp</span> <span class="id" type="var">_</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#conj"><span class="id" type="constructor">conj</span></a> <span class="id" type="var">LBm</span> <span class="id" type="var">UBm</span>) <span class="id" type="var">FSm</span>) <span class="id" type="keyword">as</span> (<span class="id" type="var">n</span>, ((<span class="id" type="var">LBn</span>, <span class="id" type="var">UBn</span>), <span class="id" type="var">FSn</span>)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <span class="id" type="var">IH</span> <span class="id" type="keyword">with</span> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs_nat"><span class="id" type="abbreviation">Zabs_nat</span></a> (<span class="id" type="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> 1)).<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Arith.Wf_nat.html#ltof"><span class="id" type="definition">ltof</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="var">zify</span>; <span class="id" type="tactic">omega</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <span class="id" type="var">fs_mult</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">rewrite</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Znat.html#inj_S"><span class="id" type="abbreviation">inj_S</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#inj_Zabs_nat"><span class="id" type="abbreviation">inj_Zabs_nat</span></a>, <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_eq"><span class="id" type="abbreviation">Zabs_eq</span></a>; <span class="id" type="tactic">auto</span> <span class="id" type="keyword">with</span> *; <span class="id" type="tactic">unfold</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Z.succ"><span class="id" type="definition">Zsucc</span></a>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">replace</span> (<span class="id" type="var">n</span> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'-'_x"><span class="id" type="notation">-</span></a> 1 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> 1) <span class="id" type="keyword">with</span> <span class="id" type="var">n</span> <span class="id" type="tactic">by</span> <span class="id" type="tactic">ring</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">split</span>; <span class="id" type="tactic">auto</span>; <span class="id" type="tactic">omega</span>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
</div>

<div class="doc">
Trivial application of the previous lemma and euler's identity 
</div>
<div class="code">

<br/>
<span class="id" type="keyword">Theorem</span> <a name="lagrange_4_square_theorem"><span class="id" type="lemma">lagrange_4_square_theorem</span></a> : <span class="id" type="keyword">∀</span> <span class="id" type="var">n</span>, 0 <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'<='_x"><span class="id" type="notation">≤</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> → <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare"><span class="id" type="definition">foursquare</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a>.<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">intros</span> <span class="id" type="var">n</span>; <span class="id" type="tactic">eapply</span> <a class="idref" href="Coqtail.Arith.Znumfacts.html#Z_prime_rect"><span class="id" type="lemma">Z_prime_rect</span></a>; <span class="id" type="tactic">auto</span>.<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">∃</span> 0); <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">∃</span> 1; <span class="id" type="tactic">repeat</span> (<span class="id" type="tactic">∃</span> 0); <span class="id" type="tactic">auto</span>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#foursquare_prime"><span class="id" type="lemma">foursquare_prime</span></a>.<br/>

<br/>
&nbsp;&nbsp;&nbsp;&nbsp;<span class="id" type="tactic">apply</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#mult_foursquare_compat"><span class="id" type="lemma">mult_foursquare_compat</span></a>.<br/>
<span class="id" type="keyword">Defined</span>.<br/>

<br/>
<span class="id" type="keyword">Definition</span> <a name="lagrange_fun"><span class="id" type="definition">lagrange_fun</span></a> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a>) : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">)</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">(</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:type_scope:x_'*'_x"><span class="id" type="notation">)</span></a> :=<br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">a</span>, <span class="id" type="var">ha</span>) := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#lagrange_4_square_theorem"><span class="id" type="lemma">lagrange_4_square_theorem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_pos"><span class="id" type="abbreviation">Zabs_pos</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a>) <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">b</span>, <span class="id" type="var">hb</span>) := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#ha"><span class="id" type="variable">ha</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">c</span>, <span class="id" type="var">hc</span>) := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#hb"><span class="id" type="variable">hb</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<span class="id" type="keyword">let</span> (<span class="id" type="var">d</span>, <span class="id" type="var">_</span> ) := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#hc"><span class="id" type="variable">hc</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">((</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">),</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">(</span></a><a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">,</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a><a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Datatypes.html#:core_scope:'('_x_','_x_','_'..'_','_x_')'"><span class="id" type="notation">))</span></a>.<br/>

<br/>
<span class="id" type="keyword">Lemma</span> <a name="lagrange_fun_spec"><span class="id" type="lemma">lagrange_fun_spec</span></a> (<span class="id" type="var">n</span> : <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Numbers.BinNums.html#Z"><span class="id" type="inductive">Z</span></a>) :<br/>
&nbsp;&nbsp;(<span class="id" type="keyword">let</span> (<span class="id" type="var">ab</span>, <span class="id" type="var">cd</span>) := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#lagrange_fun"><span class="id" type="definition">lagrange_fun</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">a</span>, <span class="id" type="var">b</span>) := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#ab"><span class="id" type="variable">ab</span></a> <span class="id" type="keyword">in</span> <span class="id" type="keyword">let</span> (<span class="id" type="var">c</span>, <span class="id" type="var">d</span>) := <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#cd"><span class="id" type="variable">cd</span></a> <span class="id" type="keyword">in</span><br/>
&nbsp;&nbsp;<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#n"><span class="id" type="variable">n</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.Init.Logic.html#:type_scope:x_'='_x"><span class="id" type="notation">=</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#a"><span class="id" type="variable">a</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#b"><span class="id" type="variable">b</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#c"><span class="id" type="variable">c</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'+'_x"><span class="id" type="notation">+</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a> <a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#:Z_scope:x_'*'_x"><span class="id" type="notation">×</span></a> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#d"><span class="id" type="variable">d</span></a>).<br/>
<span class="id" type="keyword">Proof</span>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">unfold</span> <a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#lagrange_fun"><span class="id" type="definition">lagrange_fun</span></a>.<br/>
&nbsp;&nbsp;<span class="id" type="tactic">destruct</span> (<a class="idref" href="Coqtail.Arith.Lagrange_four_square.html#lagrange_4_square_theorem"><span class="id" type="lemma">lagrange_4_square_theorem</span></a> (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.BinInt.html#Zabs"><span class="id" type="abbreviation">Zabs</span></a> <span class="id" type="var">n</span>) (<a class="idref" href="http://coq.inria.fr/distrib/8.4pl5/stdlib/Coq.ZArith.Zabs.html#Zabs_pos"><span class="id" type="abbreviation">Zabs_pos</span></a> <span class="id" type="var">n</span>)) <span class="id" type="keyword">as</span> (<span class="id" type="var">a</span>, (<span class="id" type="var">b</span>, (<span class="id" type="var">c</span>, (<span class="id" type="var">d</span>, <span class="id" type="var">pr</span>)))).<br/>
&nbsp;&nbsp;<span class="id" type="tactic">exact</span> <span class="id" type="var">pr</span>.<br/>
<span class="id" type="keyword">Qed</span>.<br/>

<br/>
<span class="id" type="keyword">Extraction</span> "Arith/Lagrange_four_square.ml" <span class="id" type="var">lagrange_fun</span>.<br/>

<br/>
</div>
</div>

<div id="footer">
<hr/><a href="index.html">Index</a><hr/>This page has been generated by <a href="http://coq.inria.fr/">coqdoc</a>
</div>

</div>

</body>
</html>